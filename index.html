<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>文机</title>

  <!-- Font Awesome (アイコン用) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <meta name="robots" content="noindex, nofollow, noarchive">
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <header>
    <div class="header-left">
      <button id="hamburger-btn" class="icon-btn" title="目次">
        <i class="fa-solid fa-bars"></i>
      </button>
      <div id="title-display" title="ファイル名">未読み込み</div>
    </div>

    <div class="header-right">
      <!-- ★検索：ボタン位置固定 + 左方向に枠が伸びるドロワー -->
      <div id="search-wrap" class="search-wrap">
        <div id="search-bar" class="search-bar">
          <div class="search-input-group">
            <input id="search-input" type="text" placeholder="検索…" autocomplete="off" />
            <button id="regex-toggle" class="icon-btn tiny" title="正規表現">
              <span class="tiny-label">.*</span>
            </button>
          </div>

          <div class="search-actions">
            <button id="search-prev" class="icon-btn tiny" title="前へ">
              <i class="fa-solid fa-chevron-left"></i>
            </button>
            <span id="search-count">0/0</span>
            <button id="search-next" class="icon-btn tiny" title="次へ">
              <i class="fa-solid fa-chevron-right"></i>
            </button>
            <button id="search-close" class="icon-btn tiny" title="閉じる">
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>
        </div>

        <button id="search-toggle-btn" class="icon-btn" title="検索">
          <i class="fa-solid fa-magnifying-glass"></i>
        </button>
      </div>

      <button id="jump-line-btn" class="icon-btn" title="行ジャンプ">
        <i class="fa-solid fa-arrow-turn-down"></i>
      </button>

      <button id="download-btn" title="ダウンロード">
        <i class="fa-solid fa-download"></i><span>DL</span>
      </button>

      <button id="edit-toggle-btn" class="icon-btn" title="編集">
        <i class="fa-solid fa-pen-to-square"></i>
      </button>

      <label class="icon-btn" title="開く">
        <i class="fa-solid fa-folder-open"></i>
        <input id="file-input" type="file" accept=".txt,text/plain" hidden />
      </label>

      <button id="settings-btn" class="icon-btn" title="設定">
        <i class="fa-solid fa-gear"></i>
      </button>
</div>
  </header>

  <div id="app-body">
    <aside id="sidebar" class="closed">
      <div class="sidebar-header">
        <h3>目次</h3>
        <div class="sidebar-actions">
          <span id="toc-count">0件</span>
          <button id="toc-settings-btn" class="icon-btn" title="目次設定">
            <i class="fa-solid fa-sliders"></i>
          </button>
        </div>
      </div>
      <ul id="toc-list"></ul>
    </aside>

    <main id="reader-container">
      <div id="drop-overlay">ここにテキストファイルをドロップ</div>

      <div id="content-area"></div>
      <textarea id="edit-textarea" spellcheck="false"></textarea>
    </main>
  </div>

  <div id="sidebar-overlay"></div>

  <!-- Settings Panel -->
  <div id="settings-panel" class="hidden">
    <div class="settings-group">
      <h4>表示</h4>
      <div class="button-row">
        <button id="mode-toggle" type="button">縦書きにする</button>
        <button id="theme-toggle" type="button">ダーク</button>
      </div>

      <label>
        フォント
        <select id="font-select">
          <option value="mincho">明朝体</option>
          <option value="gothic">ゴシック体</option>
          <option value="maru">丸ゴシック体</option>
        </select>
      </label>

      <label>
        文字サイズ
        <input id="size-range" type="range" min="12" max="36" value="18" />
      </label>

      <label>
        字間
        <input id="spacing-range" type="range" min="0" max="0.2" step="0.01" value="0.05" />
      </label>

      <label>
        行間
        <input id="line-height-range" type="range" min="1.2" max="2.6" step="0.1" value="1.8" />
      </label>
    </div>
  </div>

  <!-- TOC Settings Modal -->
  <div id="toc-settings-modal" class="modal-wrapper hidden">
    <div class="modal-box wide-modal">
      <h3>目次抽出ルール</h3>
      <p>正規表現で見出し行を判定します。</p>

      <div class="add-rule-area">
        <button id="add-rule-btn" class="outline-btn" type="button">
          <i class="fa-solid fa-plus"></i> ルール追加
        </button>
      </div>

      <hr class="modal-divider" />

      <div id="rule-list-container"></div>

      <div class="toc-rule-input">
        <label for="rule-exclude">除外パターン（任意）</label>
        <input id="rule-exclude" type="text" placeholder="例: ^(※|注)" />
      </div>

      <div class="modal-actions">
        <button id="toc-settings-close" class="secondary" type="button">閉じる</button>
        <button id="toc-settings-save" type="button">保存</button>
      </div>
    </div>
  </div>

  <!-- Jump Line Modal -->
  <div id="jump-line-modal" class="modal-wrapper hidden">
    <div class="modal-box">
      <h3>行ジャンプ</h3>
      <p>最大行数: <span id="max-line-display">0</span></p>

      <div class="jump-line-row">
        <input id="jump-line-input" type="number" min="1" inputmode="numeric" />
        <div class="jump-line-buttons">
          <button id="jump-line-exec" type="button">移動</button>
          <button id="jump-line-close" class="secondary" type="button">閉じる</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="./js/main.js"></script>
</body>
</html>
